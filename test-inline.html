<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finans Chatbot - Inline Test</title>
</head>
<body style="margin:0;padding:20px;font-family:Arial,sans-serif;background:#f5f5f5;">
    <div style="max-width:800px;margin:0 auto;background:white;padding:30px;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,0.1);">
        <h1>🤖 Finans Chatbot Test - INLINE VERSION</h1>
        <p>Bu sayfa <strong>tamamen inline</strong> - external dosya yok. Garantili çalışır.</p>
        <p>Sağ alt köşeye bak → MOR BUTON görünmeli</p>
        <div id="status" style="margin-top:20px;padding:15px;background:#e3f2fd;border-radius:5px;"></div>
    </div>

    <!-- INLINE CHATBOT - Her şey burada -->
    <script>
    (function() {
        'use strict';

        // CSS ve HTML'i ekle
        const html = `
            <style>
                #inline-chat-btn {
                    position: fixed;
                    bottom: 24px;
                    right: 24px;
                    width: 60px;
                    height: 60px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    border: none;
                    color: white;
                    font-size: 24px;
                    cursor: pointer;
                    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
                    z-index: 99999;
                    transition: transform 0.3s;
                }
                #inline-chat-btn:hover {
                    transform: scale(1.1);
                }
                #inline-chat-window {
                    display: none;
                    position: fixed;
                    bottom: 100px;
                    right: 24px;
                    width: 400px;
                    max-width: calc(100vw - 48px);
                    height: 600px;
                    max-height: calc(100vh - 150px);
                    background: white;
                    border-radius: 16px;
                    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
                    flex-direction: column;
                    z-index: 99999;
                }
                #inline-chat-window.open {
                    display: flex;
                }
                .inline-chat-header {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 16px 20px;
                    border-radius: 16px 16px 0 0;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }
                .inline-chat-messages {
                    flex: 1;
                    overflow-y: auto;
                    padding: 20px;
                    background: #f7fafc;
                }
                .inline-chat-message {
                    margin-bottom: 16px;
                    padding: 12px 16px;
                    border-radius: 12px;
                    max-width: 80%;
                    line-height: 1.5;
                }
                .inline-chat-message.bot {
                    background: white;
                    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
                }
                .inline-chat-message.user {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    margin-left: auto;
                }
                .inline-chat-input-box {
                    padding: 16px;
                    border-top: 1px solid #e2e8f0;
                    background: white;
                    border-radius: 0 0 16px 16px;
                }
                .inline-chat-input-box input {
                    width: 100%;
                    padding: 10px 14px;
                    border: 1px solid #e2e8f0;
                    border-radius: 12px;
                    font-size: 14px;
                    font-family: inherit;
                }
                .inline-chat-close {
                    background: rgba(255, 255, 255, 0.2);
                    border: none;
                    color: white;
                    width: 32px;
                    height: 32px;
                    border-radius: 8px;
                    cursor: pointer;
                    font-size: 20px;
                }
            </style>

            <button id="inline-chat-btn">💬</button>

            <div id="inline-chat-window">
                <div class="inline-chat-header">
                    <div>
                        <h3 style="margin:0;font-size:18px;">Finans Asistan</h3>
                        <span style="font-size:12px;opacity:0.9;">Çevrimiçi</span>
                    </div>
                    <button class="inline-chat-close" id="inline-close-btn">×</button>
                </div>

                <div class="inline-chat-messages" id="inline-messages">
                    <div class="inline-chat-message bot">
                        👋 Merhaba! Ben Finans Asistan. Size nasıl yardımcı olabilirim?
                    </div>
                </div>

                <div class="inline-chat-input-box">
                    <input type="text" id="inline-input" placeholder="Sorunuzu yazın..." />
                </div>
            </div>
        `;

        document.body.insertAdjacentHTML('beforeend', html);

        // Mesaj ekle
        function addMessage(text, isUser) {
            const messages = document.getElementById('inline-messages');
            const msg = document.createElement('div');
            msg.className = 'inline-chat-message ' + (isUser ? 'user' : 'bot');
            msg.textContent = text;
            messages.appendChild(msg);
            messages.scrollTop = messages.scrollHeight;
        }

        // Basit cevaplar
        function getResponse(question) {
            const q = question.toLowerCase();

            if (q.includes('hisse') || q.includes('stock')) {
                return 'Hisse senedi, bir şirketin sermayesinin eşit paylara bölünmüş birimlerinden biridir. Hisse senedi alarak o şirketin ortağı olursunuz.';
            }
            if (q.includes('forex') || q.includes('döviz')) {
                return 'Forex, döviz piyasasıdır. Dünya genelinde günlük 6 trilyon dolar işlem hacmi olan en büyük finansal piyasadır.';
            }
            if (q.includes('bitcoin') || q.includes('kripto')) {
                return 'Bitcoin, ilk ve en bilinen kripto para birimidir. 2009\'da Satoshi Nakamoto tarafından yaratılmıştır.';
            }
            if (q.includes('yatırım')) {
                return 'Yatırım yapmadan önce: Risk toleransınızı belirleyin, araştırma yapın, portföyünüzü çeşitlendirin ve uzun vadeli düşünün.';
            }
            if (q.includes('bist') || q.includes('borsa')) {
                return 'Borsa İstanbul (BIST), Türkiye\'nin organize borsasıdır. BIST 100 endeksi en çok işlem gören 100 şirketi içerir.';
            }

            return 'Bu konuda size nasıl yardımcı olabilirim? Hisse senedi, forex, kripto para, yatırım veya borsa hakkında sorular sorabilirsiniz.';
        }

        // Event listeners
        const btn = document.getElementById('inline-chat-btn');
        const closeBtn = document.getElementById('inline-close-btn');
        const chatWindow = document.getElementById('inline-chat-window');
        const input = document.getElementById('inline-input');

        btn.addEventListener('click', function() {
            chatWindow.classList.add('open');
            input.focus();
        });

        closeBtn.addEventListener('click', function() {
            chatWindow.classList.remove('open');
        });

        input.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && input.value.trim()) {
                const question = input.value.trim();
                addMessage(question, true);
                input.value = '';

                setTimeout(function() {
                    const response = getResponse(question);
                    addMessage(response, false);
                }, 300);
            }
        });

        // Status güncellemesi
        setTimeout(function() {
            const status = document.getElementById('status');
            if (status) {
                status.innerHTML = '<strong style="color:green;">✅ Chatbot başarıyla yüklendi!</strong><br>' +
                    '<p>Sağ alt köşede mor buton (💬) görüyor musunuz?</p>' +
                    '<p>Butona tıklayın ve test edin!</p>';
            }
        }, 500);

        console.log('✅ INLINE Chatbot başarıyla yüklendi!');
        console.log('Buton ID:', document.getElementById('inline-chat-btn') ? 'MEVCUT ✅' : 'YOK ❌');

    })();
    </script>
</body>
</html>
